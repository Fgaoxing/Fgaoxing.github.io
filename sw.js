var CACHE_NAME="MyCache";let cachelist=["/404.html","/NoNetwork/"],not_network="/NoNetwork/",My_Domain="www.yt-blog.top",out_url=[],debug=!0,myconsole={success:t=>{console.log(`%c${t}`,"border-left: 5px solid green;box-shadow: 0 0 32px 0 #79797951;text-decoration: none;border-radius: 3px;color:white !important;background:black;padding: 3px;")},warning:t=>{console.log(`%c${t}`,"border-left: 5px solid yellow;box-shadow: 0 0 32px 0 #79797951;text-decoration: none;border-radius: 3px;color:white !important;background:black;padding: 3px;")},info:t=>{console.log(`%c${t}`,"border-left: 5px solid dodgerblue;box-shadow: 0 0 32px 0 #79797951;text-decoration: none;border-radius: 3px;color:white !important;background:black;padding: 3px;")},error:t=>{console.log(`%c${t}`,"border-left: 5px solid red;box-shadow: 0 0 32px 0 #79797951;text-decoration: none;border-radius: 3px;color:white !important;background:black;padding: 3px;")},debug:t=>{console.log(`%c${t}`,"border-left: 5px solid gray;box-shadow: 0 0 32px 0 #79797951;text-decoration: none;border-radius: 3px;color:white !important;background:black;padding: 3px;")}},cdn={gh:{jsdelivr:{url:"https://cdn.jsdelivr.net/gh"},tianli1:{url:"https://cdn1.tianli0.top/gh"},tianli2:{url:"https://cdn2.tianli0.top/gh"},tianli3:{url:"https://cdn3.tianli0.top/gh"},tianli5:{url:"https://cdn5.tianli0.top/gh"},cdnn:{url:"https://cdn.yt-blog.top/gh"},xyh:{url:"https://cdn.oblivionocean.top/gh"},cky:{url:"https://jsew.cky.codes/gh"},ftft:{url:"https://jsd.iftft.com/gh"}},combine:{jsdelivr:{url:"https://cdn.jsdelivr.net/combine"},chuqi:{url:"https://cdn.chuqis.com/combine"}},npm:{eleme:{url:"https://npm.elemecdn.com"},jsdelivr:{url:"https://cdn.jsdelivr.net/npm"},jjz:{url:"https://jsd.onmicrosoft.cn/npm"},jjz_unpkg:{url:"https://unpkg.onmicrosoft.cn"},jjz_unpkg:{url:"https://npm.onmicrosoft.cn"},sourceg:{url:"https://npm.sourcegcdn.com"},GNT:{url:"https://cdn.bilicdn.tk/npm"},tianli1:{url:"https://cdn1.tianli0.top/npm"},tianli2:{url:"https://cdn2.tianli0.top/npm"},tianli3:{url:"https://cdn3.tianli0.top/npm"},tianli5:{url:"https://cdn5.tianli0.top/npm"},unpkg:{url:"https://unpkg.com"},chuqi:{url:"https://cdn.chuqis.com/npm"},afdelivr:{url:"https://cdn.afdelivr.com/npm"},sourcegcdn:{url:"https://npm.sourcegcdn.com"}},cdnjs:{cdnjs:{url:"https://cdnjs.cloudflare.com/ajax/libs"},jsdelivr:{url:"https://cdn.jsdelivr.net/gh/cdnjs/cdnjs@master/ajax/libs"},tianli:{url:"https://cdn1.tianli0.top/gh/cdnjs/cdnjs@master/ajax/libs"},cdnn:{url:"https://cdn.yt-blog.top/cdnjs"},xyh:{url:"https://cdn.oblivionocean.top/cdnjs"},nkd:{url:"https://mirrors.sustech.edu.cn/cdnjs/ajax/libs"},bootcdn:{url:"https://cdn.bootcdn.net/ajax/libs"},baomitu:{url:"https://lib.baomitu.com"},staticfile:{url:"https://cdn.staticfile.org"},sourcegcdn:{url:"https://cdnjs.sourcegcdn.com/ajax/libs"}},myblog:{mian:{url:"https://www.yt-blog.top"},vercel:{url:"https://vercel.yt-blog.top"},vercelcn:{url:"https://vercel-china.yt-blog.top"},github:{url:"https://github.yt-blog.top"},cfpage:{url:"https://cfpage.yt-blog.top"},cfpage2:{url:"https://fgaoxing-github-io.pages.dev"},netlify:{url:"https://netlify.yt-blog.top"},gcore:{url:"https://gcore.yt-blog.top"}}};self.db={read:(t,n)=>(n||(n={type:"text"}),new Promise(((n,e)=>{caches.open(CACHE_NAME).then((e=>{e.match(new Request(`https://LOCALCACHE/${encodeURIComponent(t)}`)).then((function(t){t||n(null),t.text().then((t=>n(t)))})).catch((()=>{n(null)}))}))}))),write:(t,n)=>new Promise(((e,o)=>{caches.open(CACHE_NAME).then((function(o){o.put(new Request(`https://LOCALCACHE/${encodeURIComponent(t)}`),new Response(n)),e()})).catch((()=>{o()}))}))},self.addEventListener("install",(function(t){self.skipWaiting(),t.waitUntil(caches.open(CACHE_NAME).then((function(t){db.read("uuid").then((function(n){return n||(myconsole.info("SW初始化"),db.write("uuid","xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=16*Math.random()|0;return("x"==t?n:3&n|8).toString(16)})))),myconsole.info("SW开始"),t.addAll(cachelist)}))})))}));const lfetch=function(t,n){let e=new AbortController;const o=function(t){return new Promise(((n,e)=>{t.arrayBuffer().then((function(e){n(new Response(e,{status:t.status,headers:t.headers}))})).catch((function(t){e(t)}))}))};return Promise.any||(Promise.any=function(t){return new Promise(((n,e)=>{let o=(t=Array.isArray(t)?t:[]).length,r=[];if(0===o)return e(new AggregateError("All promises were rejected"));t.forEach((t=>{t.then((t=>{n(t)}),(t=>{o--,r.push(t),0===o&&e(new AggregateError(r))}))}))}))}),Promise.any(t.map((t=>new Promise(((n,r)=>{fetch(t,{signal:e.signal,mode:-1!==t.indexOf("https://netlify.yt-blog.top")?"no-cors":"cors"}).then(o).then((t=>{200==t.status?(e.abort(),n(t)):r(t)})).catch((function(t){"AbortError: The user aborted a request."!==t.toString()&&(myconsole.error("无法请求"+t.toString()),r(t))}))}))))).catch((function(n){return new Promise((function(r,c){"Uncaught (in promise) AggregateError: All promises were rejected"===n.toString()&&fetch(t,{signal:e.signal}).then(o).then((t=>{r(t)})).catch((function(t){"AbortError: The user aborted a request."!==t.toString()&&c(t)}))}))}))},handleerr=function(t,n){return t.url.split("/")[2]===My_Domain||-1!==t.url.split("/")[2].indexOf("localhost")?caches.match(t).then((function(t){return myconsole.warning("当前域名下的页面请求失败，推测可能是无法与服务器通信，读取缓存"),t||caches.match(new Request(not_network))})):new Response(`<p>资源发生错误</p>\n    <p>${n}</p>`,{headers:{"content-type":"text/html; charset=utf-8"}})},handle=async function(t){const n=t.url;let e=new URL(n);const o=e.href.substr(e.origin.length),r=n.split("/")[2];if(o.match(/\/sw\.js/g))return fetch(t);for(let t in cdn){if(n in out_url){myconsole.info(n+" 被禁止加速");break}for(let e in cdn[t])if(r==(cdn[t][e].url.indexOf("https://")<0?cdn[t][e].url.split("http://")[1].split("/")[0]:cdn[t][e].url.split("https://")[1].split("/")[0])&&n.match(cdn[t][e].url)){let o=[];for(let r in cdn[t])o.push(n.replace(cdn[t][e].url,cdn[t][r].url));return lfetch(o).then((function(t){return t}))}}return myconsole.warning(t.url+" 没有加速"),fetch(t).then((function(n){if(!n)throw"error";return caches.open(CACHE_NAME).then((function(e){return"http"!==t.url.split(":")[0]&&"https"!==t.url.split(":")[0]||(e.delete(t).catch((function(t){})),e.put(t,n.clone()).catch((function(t){}))),n})).catch((function(t){}))})).catch((function(n){return myconsole.error(t.url+" 请求失败"),r===My_Domain||-1!==r.indexOf("localhost")?caches.match(t).then((function(t){return myconsole.warning("当前域名下的页面请求失败，推测可能是无法与服务器通信，读取缓存"),t||caches.match(new Request(not_network))})):new Response(`<h1>资源发生错误</h1>\n    <b>${n}</b>`,{headers:{"content-type":"text/html; charset=utf-8"}})}))};self.addEventListener("fetch",(async t=>{try{t.respondWith(handle(t.request)),myconsole.success(t.request.url+" 请求成功")}catch(n){t.respondWith(handleerr(t.request,n))}})),self.addEventListener("activate",(async function(t){self.clients.claim()}));
//# sourceMappingURL=maps/sw.js.map
