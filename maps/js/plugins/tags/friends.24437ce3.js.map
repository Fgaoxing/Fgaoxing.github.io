{"version":3,"file":"../../../../js/plugins/tags/friends.24437ce3.js","names":["FriendsJS","requestAPI","e","t","r","n","a","Promise","o","s","i","l","setTimeout","fetch","then","clearTimeout","ok","json","Error","catch","layout","el","api","querySelector","remove","content","forEach","url","title","avatar","innerHTML","innerText","start","document","getElementsByClassName","length","getAttribute","Object","class","volantis","GLOBAL_CONFIG","default","addEventListener"],"sources":["js/plugins/tags/friends.24437ce3.js"],"mappings":"AAAA,MAAMA,UAAU,CAACC,WAAW,CAACC,EAAEC,EAAEC,KAAK,IAAIC,EAAE,GAAG,SAASC,IAAI,OAAO,IAAIC,SAAQ,CAAEC,EAAEC,KAAK,IAAIC,EAAE,EAAEC,EAAEC,YAAW,KAAM,IAAIF,IAAIA,EAAE,EAAEC,EAAE,KAAKF,EAAE,QAAQ,GAAGJ,GAAGD,IAAK,GAAE,KAAKS,MAAMX,GAAGY,MAAK,SAAUZ,GAAG,GAAG,IAAIQ,IAAIK,aAAaJ,GAAGH,EAAEN,GAAGS,EAAE,KAAKD,EAAE,GAAGR,EAAEc,GAAG,OAAOd,EAAEe,OAAO,MAAM,IAAIC,MAAM,+BAAgC,IAAGJ,MAAK,SAAUZ,GAAGG,EAAE,EAAEF,EAAED,EAAG,IAAGiB,OAAM,SAAUjB,GAAGG,EAAE,GAAGA,GAAG,EAAEO,YAAW,KAAMN,GAAI,GAAE,MAAMF,GAAI,GAAG,GAAE,CAAnW,EAAqW,EAAGgB,OAAOlB,IAAI,MAAMC,EAAED,EAAEmB,GAAGrB,UAAUC,WAAWC,EAAEoB,KAAI,SAAUlB,GAAGD,EAAEoB,cAAc,iBAAiBC,SAAS,MAAMnB,EAAED,EAAEqB,QAAQ,IAAInB,EAAE,GAAGD,EAAEqB,SAAQ,CAAEvB,EAAEC,KAAK,IAAIC,EAAE,0BAA0BA,GAAG,0EAA0EA,GAAG,UAAUF,EAAEwB,IAAI,KAAKtB,GAAG,aAAaF,EAAEyB,MAAM,WAAWzB,EAAE0B,QAAQ3B,EAAE2B,QAAQ,oCAAoCxB,GAAG,2BAA2BF,EAAEyB,MAAM,gBAAgBvB,GAAG,OAAOC,GAAGD,GAAG,QAAS,IAAGF,EAAEoB,cAAc,eAAeO,UAAUxB,CAAE,IAAE,WAAY,IAAIH,EAAEoB,cAAc,qBAAqBC,SAASrB,EAAEoB,cAAc,mBAAmBQ,UAAU,cAAc,CAAC,MAAM7B,GAAG,CAAE,GAAC,EAAG8B,MAAM,KAAK,MAAM9B,EAAE+B,SAASC,uBAAuB,kBAAkB,IAAI,IAAI/B,EAAE,EAAEA,EAAED,EAAEiC,OAAOhC,IAAI,CAAC,MAAME,EAAEH,EAAEC,GAAGG,EAAED,EAAE+B,aAAa,OAAO,GAAG,MAAM9B,EAAE,CAAC,IAAIF,EAAE,IAAIiC,OAAOjC,EAAEiB,GAAGhB,EAAED,EAAEkB,IAAIhB,EAAEF,EAAEkC,MAAMjC,EAAE+B,aAAa,SAAShC,EAAEyB,OAAOU,SAASC,cAAcC,QAAQZ,OAAO7B,UAAUoB,OAAOhB,EAAE,CAAC,IAAIJ,UAAUgC,QAAQC,SAASS,iBAAiB,iBAAgB,WAAY1C,UAAUgC,OAAQ","sourcesContent":["const FriendsJS={requestAPI:(e,t,r)=>{let n=5;!function a(){return new Promise(((o,s)=>{let i=0,l=setTimeout((()=>{0===i&&(i=2,l=null,s(\"请求超时\"),0==n&&r())}),5e3);fetch(e).then((function(e){if(2!==i&&(clearTimeout(l),o(e),l=null,i=1),e.ok)return e.json();throw new Error(\"Network response was not ok.\")})).then((function(e){n=0,t(e)})).catch((function(e){n>0?(n-=1,setTimeout((()=>{a()}),5e3)):r()}))}))}()},layout:e=>{const t=e.el;FriendsJS.requestAPI(e.api,(function(r){t.querySelector(\".loading-wrap\").remove();const n=r.content;var a=\"\";n.forEach(((t,r)=>{var n='<div class=\"user-card\">';n+='<a class=\"card-link\" target=\"_blank\" rel=\"external noopener noreferrer\"',n+=' href=\"'+t.url+'\">',n+='<img alt=\"'+t.title+'\" src=\"'+(t.avatar||e.avatar)+'\" onerror=\"errorImgAvatar(this)\">',n+='<div class=\"name\"><span>'+t.title+\"</span></div>\",n+=\"</a>\",a+=n+=\"</div>\"})),t.querySelector(\".group-body\").innerHTML=a}),(function(){try{t.querySelector(\".loading-wrap svg\").remove(),t.querySelector(\".loading-wrap p\").innerText(\"加载失败，请稍后重试。\")}catch(e){}}))},start:()=>{const e=document.getElementsByClassName(\"friendsjs-wrap\");for(var t=0;t<e.length;t++){const n=e[t],a=n.getAttribute(\"api\");if(null!=a){var r=new Object;r.el=n,r.api=a,r.class=n.getAttribute(\"class\"),r.avatar=volantis.GLOBAL_CONFIG.default.avatar,FriendsJS.layout(r)}}}};FriendsJS.start(),document.addEventListener(\"pjax:complete\",(function(){FriendsJS.start()}));"]}